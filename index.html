<!DOCTYPE html>
<html>
<head>
    <title>D&D Dice Roller</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cinzel', serif;
            background: linear-gradient(to bottom, #2F1B0D, #5C4033); /* Dark wood gradient */
            color: #FFD700; /* Gold text */
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        #main-container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7); /* Semi-transparent black for contrast */
            padding: 20px;
            border: 3px solid #FFD700;
            border-radius: 10px;
        }
        h1 {
            font-size: 36px;
            text-shadow: 0 0 10px #FFD700;
        }
        #dice-selection {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .die-selection {
            display: flex;
            align-items: center;
            background: #8B0000; /* Dark red */
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #FFD700;
        }
        .die-selection span {
            margin: 0 10px;
            font-size: 18px;
        }
        button {
            background-color: #8B0000;
            color: #FFD700;
            border: 2px solid #FFD700;
            padding: 5px 10px;
            font-family: 'Cinzel', serif;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 0 5px #FFD700;
            transition: all 0.3s;
        }
        button:hover {
            background-color: #A52A2A;
            box-shadow: 0 0 10px #FFD700;
        }
        #dice-canvas {
            height: 400px;
            background: #1A0F0A; /* Dark background for canvas */
            border: 2px solid #FFD700;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        #roll-button {
            padding: 10px 30px;
            font-size: 20px;
        }
        #results {
            font-size: 18px;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
        }
        #results ul {
            list-style: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="main-container">
        <h1>D&D Dice Roller</h1>
        <div id="dice-selection">
            <div class="die-selection">
                <span>d4</span>
                <button class="minus" data-type="d4">-</button>
                <span class="count" data-type="d4">0</span>
                <button class="plus" data-type="d4">+</button>
            </div>
            <div class="die-selection">
                <span>d6</span>
                <button class="minus" data-type="d6">-</button>
                <span class="count" data-type="d6">0</span>
                <button class="plus" data-type="d6">+</button>
            </div>
            <div class="die-selection">
                <span>d8</span>
                <button class="minus" data-type="d8">-</button>
                <span class="count" data-type="d8">0</span>
                <button class="plus" data-type="d8">+</button>
            </div>
            <div class="die-selection">
                <span>d10</span>
                <button class="minus" data-type="d10">-</button>
                <span class="count" data-type="d10">0</span>
                <button class="plus" data-type="d10">+</button>
            </div>
            <div class="die-selection">
                <span>d12</span>
                <button class="minus" data-type="d12">-</button>
                <span class="count" data-type="d12">0</span>
                <button class="plus" data-type="d12">+</button>
            </div>
            <div class="die-selection">
                <span>d20</span>
                <button class="minus" data-type="d20">-</button>
                <span class="count" data-type="d20">0</span>
                <button class="plus" data-type="d20">+</button>
            </div>
        </div>
        <div id="dice-canvas"></div>
        <button id="roll-button">Roll</button>
        <div id="results"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <script>
        // Three.js setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 10;
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth * 0.8, 400);
        document.getElementById('dice-canvas').appendChild(renderer.domElement);

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 10, 5);
        scene.add(directionalLight);

        // Dice management
        const diceCounts = { d4: 0, d6: 0, d8: 0, d10: 0, d12: 0, d20: 0 };
        const selectedDice = [];
        let isRolling = false;

        function createDie(type) {
            let geometry;
            switch (type) {
                case 'd4': geometry = new THREE.TetrahedronGeometry(1); break;
                case 'd6': geometry = new THREE.BoxGeometry(1, 1, 1); break;
                case 'd8': geometry = new THREE.OctahedronGeometry(1); break;
                case 'd10': geometry = new THREE.DodecahedronGeometry(1); break; // Approximation
                case 'd12': geometry = new THREE.DodecahedronGeometry(1); break;
                case 'd20': geometry = new THREE.IcosahedronGeometry(1); break;
            }
            const material = new THREE.MeshPhongMaterial({
                color: getColorForType(type),
                shininess: 100,
                specular: 0x555555
            });
            const mesh = new THREE.Mesh(geometry, material);
            return mesh;
        }

        function getColorForType(type) {
            switch (type) {
                case 'd4': return 0xFF00FF; // Magenta
                case 'd6': return 0x00CED1; // Teal
                case 'd8': return 0x32CD32; // Lime green
                case 'd10': return 0xFF4500; // Orange-red
                case 'd12': return 0xFFA500; // Orange
                case 'd20': return 0xFFD700; // Gold
            }
        }

        function addDie(type) {
            diceCounts[type]++;
            const die = { type, faces: parseInt(type.slice(1)), mesh: createDie(type) };
            selectedDice.push(die);
            scene.add(die.mesh);
            positionDice();
            updateCountDisplay(type);
        }

        function removeDie(type) {
            if (diceCounts[type] > 0) {
                diceCounts[type]--;
                const index = selectedDice.findIndex(d => d.type === type);
                if (index !== -1) {
                    scene.remove(selectedDice[index].mesh);
                    selectedDice.splice(index, 1);
                }
                positionDice();
                updateCountDisplay(type);
            }
        }

        function updateCountDisplay(type) {
            document.querySelector(`.count[data-type="${type}"]`).textContent = diceCounts[type];
        }

        function positionDice() {
            const spacing = 2.5;
            const startX = - (selectedDice.length - 1) * spacing / 2;
            selectedDice.forEach((die, index) => {
                die.mesh.position.set(startX + index * spacing, 0, 0);
            });
            // Adjust camera if many dice
            camera.position.z = Math.max(10, selectedDice.length * 2);
        }

        // Event listeners for dice selection
        document.querySelectorAll('.plus').forEach(button => {
            button.addEventListener('click', () => addDie(button.dataset.type));
        });
        document.querySelectorAll('.minus').forEach(button => {
            button.addEventListener('click', () => removeDie(button.dataset.type));
        });

        // Roll button logic
        document.getElementById('roll-button').addEventListener('click', () => {
            if (selectedDice.length === 0) return;
            isRolling = true;
            selectedDice.forEach(die => {
                die.rotationSpeedX = (Math.random() - 0.5) * 0.1;
                die.rotationSpeedY = (Math.random() - 0.5) * 0.1;
                die.rotationSpeedZ = (Math.random() - 0.5) * 0.1;
            });
            const results = selectedDice.map(die => ({
                type: die.type,
                roll: Math.floor(Math.random() * die.faces) + 1
            }));
            const total = results.reduce((sum, r) => sum + r.roll, 0);
            setTimeout(() => {
                isRolling = false;
                selectedDice.forEach(die => {
                    die.rotationSpeedX = die.rotationSpeedY = die.rotationSpeedZ = 0;
                });
                const resultsHtml = results.map(r => `<li>${r.type}: ${r.roll}</li>`).join('');
                document.getElementById('results').innerHTML = `<p>Rolls:</p><ul>${resultsHtml}</ul><p>Total: ${total}</p>`;
            }, 2000); // 2-second roll animation
        });

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            if (isRolling) {
                selectedDice.forEach(die => {
                    die.mesh.rotation.x += die.rotationSpeedX;
                    die.mesh.rotation.y += die.rotationSpeedY;
                    die.mesh.rotation.z += die.rotationSpeedZ;
                });
            }
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
